generator client {
  provider = "prisma-client-js"
}

generator py {
  provider             = "prisma-client-py"
  interface            = "asyncio"
  recursive_type_depth = "-1"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                  String      @id @default(cuid())
  email               String      @unique
  username            String      @unique
  passwordHash        String
  role                UserRole    @default(PLAYER)
  createdAt           DateTime    @default(now())
  updatedAt           DateTime    @updatedAt
  lastLoginAt         DateTime?
  resetToken          String?     @map("reset_token")
  resetTokenExpiry    DateTime?   @map("reset_token_expiry")
  failedLoginAttempts Int         @default(0) @map("failed_login_attempts")
  lockedUntil         DateTime?   @map("locked_until")
  lastFailedLogin     DateTime?   @map("last_failed_login")
  auditLogs           AuditLog[]
  issuedBans          BanRecord[] @relation("BanningAdmin")
  banRecords          BanRecord[] @relation("BannedUser")
  changeLogs          ChangeLog[]
  characters          Character[]

  @@map("users")
}

model Character {
  id             String            @id @default(cuid())
  name           String            @unique
  level          Int               @default(1)
  alignment      Int               @default(0)
  strength       Int               @default(13)
  intelligence   Int               @default(13)
  wisdom         Int               @default(13)
  dexterity      Int               @default(13)
  constitution   Int               @default(13)
  charisma       Int               @default(13)
  luck           Int               @default(13)
  hitPoints      Int               @default(100)
  movement       Int               @default(100)
  hitPointsMax   Int               @default(100)
  movementMax    Int               @default(100)
  copper         Int               @default(0)
  silver         Int               @default(0)
  gold           Int               @default(0)
  platinum       Int               @default(0)
  bankCopper     Int               @default(0) @map("bank_copper")
  bankSilver     Int               @default(0) @map("bank_silver")
  bankGold       Int               @default(0) @map("bank_gold")
  bankPlatinum   Int               @default(0) @map("bank_platinum")
  total_wealth   Int               @default(0)
  average_stats  Int               @default(13)
  passwordHash   String?           @map("password_hash")
  raceType       String            @default("human") @map("race_type")
  race           Race              @default(HUMAN)
  gender         String            @default("neutral")
  playerClass    String?           @map("player_class")
  height         Int?
  weight         Int?
  baseSize       Int               @default(0) @map("base_size")
  currentSize    Int               @default(0) @map("current_size")
  hitRoll        Int               @default(0) @map("hit_roll")
  damageRoll     Int               @default(0) @map("damage_roll")
  armorClass     Int               @default(10) @map("armor_class")
  currentRoom    Int?              @map("current_room")
  saveRoom       Int?              @map("save_room")
  homeRoom       Int?              @map("home_room")
  lastLogin      DateTime?         @map("last_login")
  timePlayed     Int               @default(0) @map("time_played")
  isOnline       Boolean           @default(false) @map("is_online")
  hunger         Int               @default(0)
  thirst         Int               @default(0)
  description    String?
  title          String?
  prompt         String            @default("<%h/%Hhp %v/%Vmv>")
  pageLength     Int               @default(25) @map("page_length")
  playerFlags    String[]          @default([]) @map("player_flags")
  effectFlags    String[]          @default([]) @map("effect_flags")
  privilegeFlags String[]          @default([]) @map("privilege_flags")
  olcZones       Int[]             @default([]) @map("olc_zones")
  invisLevel     Int               @default(0) @map("invis_level")
  birthTime      DateTime          @default(now()) @map("birth_time")
  userId         String
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  classId        Int?
  experience     Int               @default(0)
  skillPoints    Int               @default(0)
  effects        CharacterEffect[]
  items          CharacterItem[]
  skills         CharacterSkill[]
  spells         CharacterSpell[]
  gameClass      GameClass?        @relation(fields: [classId], references: [id])
  user           User              @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("characters")
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model Zone {
  id           Int           @id
  name         String
  lifespan     Int           @default(30)
  resetMode    ResetMode     @default(NORMAL)
  hemisphere   Hemisphere    @default(NORTHWEST)
  climate      Climate       @default(NONE)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  deleted_at   DateTime?
  createdBy    String?
  updatedBy    String?
  mobResets    MobReset[]
  mobs         Mob[]
  objectResets ObjectReset[]
  objects      Object[]
  rooms        Room[]
  shops        Shop[]
  triggers     Trigger[]

  @@map("zones")
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model Room {
  id           Int
  name         String
  description  String
  sector       Sector                 @default(STRUCTURE)
  zoneId       Int
  createdAt    DateTime               @default(now())
  updatedAt    DateTime               @updatedAt
  deleted_at   DateTime?
  createdBy    String?
  updatedBy    String?
  flags        RoomFlag[]
  layoutX      Int?                   @map("layout_x")
  layoutY      Int?                   @map("layout_y")
  layoutZ      Int?                   @default(0) @map("layout_z")
  mobResets    MobReset[]
  objectResets ObjectReset[]
  exits        RoomExit[]
  extraDescs   RoomExtraDescription[]
  zone         Zone                   @relation(fields: [zoneId], references: [id], onDelete: Cascade)

  @@id([zoneId, id])
  @@map("rooms")
}

model RoomExit {
  id          String    @id @default(cuid())
  direction   Direction
  description String?
  keyword     String?
  key         String?
  destination Int?
  roomZoneId  Int
  roomId      Int
  room        Room      @relation(fields: [roomZoneId, roomId], references: [zoneId, id], onDelete: Cascade)
  flags       ExitFlag[] @default([])

  @@unique([roomZoneId, roomId, direction])
  @@map("room_exits")
}

model RoomExtraDescription {
  id          String @id @default(cuid())
  keyword     String
  description String
  roomZoneId  Int
  roomId      Int
  room        Room   @relation(fields: [roomZoneId, roomId], references: [zoneId, id], onDelete: Cascade)

  @@map("room_extra_descriptions")
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model Mob {
  id              Int
  keywords        String[]
  mobClass        String
  shortDesc       String
  longDesc        String
  desc            String
  alignment       Int          @default(0)
  level           Int          @default(1)
  armorClass      Int          @default(0)
  hitRoll         Int          @default(0)
  move            Int          @default(0)
  hpDiceNum       Int          @default(0)
  hpDiceSize      Int          @default(0)
  hpDiceBonus     Int          @default(0)
  damageDiceNum   Int          @default(0)
  damageDiceSize  Int          @default(0)
  damageDiceBonus Int          @default(0)
  copper          Int          @default(0)
  silver          Int          @default(0)
  gold            Int          @default(0)
  platinum        Int          @default(0)
  raceAlign       Int          @default(0)
  total_wealth    Int          @default(0)
  average_stats   Int          @default(13)
  estimated_hp    Int          @default(0)
  strength        Int          @default(13)
  intelligence    Int          @default(13)
  wisdom          Int          @default(13)
  dexterity       Int          @default(13)
  constitution    Int          @default(13)
  charisma        Int          @default(13)
  perception      Int          @default(0)
  concealment     Int          @default(0)
  zoneId          Int
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt
  deleted_at      DateTime?
  createdBy       String?
  updatedBy       String?
  classId         Int?
  race            Race         @default(HUMANOID)
  mobFlags        MobFlag[]
  effectFlags     EffectFlag[]
  position        Position     @default(STANDING)
  defaultPosition Position     @default(STANDING)
  gender          Gender       @default(NEUTRAL)
  size            Size         @default(MEDIUM)
  lifeForce       LifeForce    @default(LIFE)
  composition     Composition  @default(FLESH)
  stance          Stance       @default(ALERT)
  damageType      DamageType   @default(HIT)
  resets          MobReset[]
  skills          MobSkill[]
  spells          MobSpell[]
  gameClass       GameClass?   @relation(fields: [classId], references: [id])
  zone            Zone         @relation(fields: [zoneId], references: [id], onDelete: Cascade)
  shops           Shop[]
  triggers        Trigger[]

  @@id([zoneId, id])
  @@map("mobs")
}

model MobSkill {
  id        Int   @id @default(autoincrement())
  mobZoneId Int
  mobId     Int
  skillId   Int
  level     Int   @default(1)
  mob       Mob   @relation(fields: [mobZoneId, mobId], references: [zoneId, id], onDelete: Cascade)
  skill     Skill @relation(fields: [skillId], references: [id], onDelete: Cascade)

  @@unique([mobZoneId, mobId, skillId])
  @@map("mob_skills")
}

model MobSpell {
  id        Int     @id @default(autoincrement())
  mobZoneId Int
  mobId     Int
  spellId   Int
  circle    Int     @default(1)
  known     Boolean @default(true)
  mob       Mob     @relation(fields: [mobZoneId, mobId], references: [zoneId, id], onDelete: Cascade)
  spell     Spell   @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@unique([mobZoneId, mobId, spellId])
  @@map("mob_spells")
}

model MobReset {
  id              String            @id @default(cuid())
  max             Int               @default(1)
  name            String?
  mobZoneId       Int
  mobId           Int
  roomZoneId      Int
  roomId          Int
  zoneId          Int
  probability     Float             @default(1.0)
  carrying        MobCarrying[]
  equipmentSets   MobEquipmentSet[]
  equipped        MobEquipped[]
  mob             Mob               @relation(fields: [mobZoneId, mobId], references: [zoneId, id], onDelete: Cascade)
  room            Room              @relation(fields: [roomZoneId, roomId], references: [zoneId, id], onDelete: Cascade)
  zone            Zone              @relation(fields: [zoneId], references: [id], onDelete: Cascade)
  spawnConditions SpawnCondition[]

  @@map("mob_resets")
}

model MobCarrying {
  id           String   @id @default(cuid())
  max          Int      @default(1)
  name         String?
  objectZoneId Int
  objectId     Int
  resetId      String
  object       Object   @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)
  reset        MobReset @relation(fields: [resetId], references: [id], onDelete: Cascade)

  @@map("mob_carrying")
}

model MobEquipped {
  id           String   @id @default(cuid())
  max          Int      @default(1)
  location     String
  name         String?
  objectZoneId Int
  objectId     Int
  resetId      String
  object       Object   @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)
  reset        MobReset @relation(fields: [resetId], references: [id], onDelete: Cascade)

  @@map("mob_equipped")
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model Object {
  id                Int
  type              ObjectType               @default(NOTHING)
  keywords          String[]
  shortDesc         String
  description       String
  actionDesc        String?
  weight            Float                    @default(0.0)
  cost              Int                      @default(0)
  timer             Int                      @default(0)
  decomposeTimer    Int                      @default(0)
  level             Int                      @default(1)
  concealment       Int                      @default(0)
  values            Json                     @default("{}")
  zoneId            Int
  createdAt         DateTime                 @default(now())
  updatedAt         DateTime                 @updatedAt
  deleted_at        DateTime?
  createdBy         String?
  updatedBy         String?
  flags             ObjectFlag[]
  effectFlags       EffectFlag[]
  wearFlags         WearFlag[]
  characterItems    CharacterItem[]
  equipmentSetItems EquipmentSetItem[]
  mobCarrying       MobCarrying[]
  mobEquipped       MobEquipped[]
  affects           ObjectAffect[]
  extraDescs        ObjectExtraDescription[]
  resets            ObjectReset[]
  spells            ObjectSpell[]
  zone              Zone                     @relation(fields: [zoneId], references: [id], onDelete: Cascade)
  shopItems         ShopItem[]
  triggers          Trigger[]

  @@id([zoneId, id])
  @@map("objects")
}

model ObjectExtraDescription {
  id           String @id @default(cuid())
  keyword      String
  description  String
  objectZoneId Int
  objectId     Int
  object       Object @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)

  @@map("object_extra_descriptions")
}

model ObjectAffect {
  id           String @id @default(cuid())
  location     String
  modifier     Int
  objectZoneId Int
  objectId     Int
  object       Object @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)

  @@map("object_affects")
}

model ObjectSpell {
  id           String @id @default(cuid())
  spell        String
  level        Int    @default(1)
  objectZoneId Int
  objectId     Int
  object       Object @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)

  @@map("object_spells")
}

model Shop {
  id              Int
  buyProfit       Float            @default(1.0)
  sellProfit      Float            @default(1.0)
  temper1         Int              @default(0)
  noSuchItem1     String?
  noSuchItem2     String?
  doNotBuy        String?
  missingCash1    String?
  missingCash2    String?
  messageBuy      String?
  messageSell     String?
  keeperZoneId    Int?
  keeperId        Int?
  zoneId          Int
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  createdBy       String?
  updatedBy       String?
  flags           ShopFlag[]
  tradesWithFlags ShopTradesWith[]
  accepts         ShopAccept[]
  hours           ShopHour[]
  items           ShopItem[]
  rooms           ShopRoom[]
  keeper          Mob?             @relation(fields: [keeperZoneId, keeperId], references: [zoneId, id])
  zone            Zone             @relation(fields: [zoneId], references: [id], onDelete: Cascade)

  @@id([zoneId, id])
  @@map("shops")
}

model ShopItem {
  id           String @id @default(cuid())
  amount       Int    @default(0)
  shopZoneId   Int
  shopId       Int
  objectZoneId Int
  objectId     Int
  object       Object @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)
  shop         Shop   @relation(fields: [shopZoneId, shopId], references: [zoneId, id], onDelete: Cascade)

  @@unique([shopZoneId, shopId, objectZoneId, objectId])
  @@map("shop_items")
}

model ShopAccept {
  id         String   @id @default(cuid())
  type       String
  keywords   String[]
  shopZoneId Int
  shopId     Int
  shop       Shop    @relation(fields: [shopZoneId, shopId], references: [zoneId, id], onDelete: Cascade)

  @@map("shop_accepts")
}

model ShopRoom {
  id         String @id @default(cuid())
  roomId     Int
  shopZoneId Int
  shopId     Int
  shop       Shop   @relation(fields: [shopZoneId, shopId], references: [zoneId, id], onDelete: Cascade)

  @@unique([shopZoneId, shopId, roomId])
  @@map("shop_rooms")
}

model ShopHour {
  id         String @id @default(cuid())
  open       Int
  close      Int
  shopZoneId Int
  shopId     Int
  shop       Shop   @relation(fields: [shopZoneId, shopId], references: [zoneId, id], onDelete: Cascade)

  @@map("shop_hours")
}

model Trigger {
  id           String        @id @default(cuid())
  name         String
  attachType   ScriptType
  numArgs      Int           @default(0)
  argList      String?
  commands     String
  zoneId       Int?
  mobZoneId    Int?
  mobId        Int?
  objectZoneId Int?
  objectId     Int?
  variables    Json          @default("{}")
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  createdBy    String?
  updatedBy    String?
  flags        TriggerFlag[]
  mob          Mob?          @relation(fields: [mobZoneId, mobId], references: [zoneId, id], onDelete: Cascade)
  object       Object?       @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)
  zone         Zone?         @relation(fields: [zoneId], references: [id], onDelete: Cascade)

  @@map("triggers")
}

model AuditLog {
  id         String   @id @default(cuid())
  action     String
  entityType String
  entityId   String
  oldValues  Json?
  newValues  Json?
  userId     String
  createdAt  DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("audit_logs")
}

model GameClass {
  id           Int                @id @default(autoincrement())
  name         String             @unique
  description  String?
  hitDice      String             @default("1d8")
  primaryStat  String?
  createdAt    DateTime           @default(now())
  updatedAt    DateTime           @updatedAt
  characters   Character[]
  skillAccess  ClassSkill[]
  mobs         Mob[]
  spellCircles SpellClassCircle[]

  @@map("classes")
}

model Spell {
  id              Int                @id @default(autoincrement())
  name            String             @unique
  schoolId        Int?
  minPosition     Position           @default(STANDING)
  violent         Boolean            @default(false)
  castTimeRounds  Int                @default(1)
  cooldownMs      Int                @default(0)
  inCombatOnly    Boolean            @default(false)
  isArea          Boolean            @default(false)
  notes           String?
  createdAt       DateTime           @default(now())
  updatedAt       DateTime           @updatedAt
  characterSpells CharacterSpell[]
  mobSpells       MobSpell[]
  classCircles    SpellClassCircle[]
  components      SpellComponent[]
  effects         SpellEffect[]
  messages        SpellMessage?
  restrictions    SpellRestriction?
  savingThrows    SpellSavingThrow[]
  targeting       SpellTargeting?
  school          SpellSchool?       @relation(fields: [schoolId], references: [id])

  @@map("spells")
}

model SpellSchool {
  id          Int     @id @default(autoincrement())
  name        String  @unique
  description String?
  spells      Spell[]

  @@map("spell_schools")
}

model SpellClassCircle {
  id              Int   @id @default(autoincrement())
  spellId         Int
  classId         Int
  circle          Int
  minLevel        Int?
  proficiencyGain Int?
  gameClass       GameClass @relation(fields: [classId], references: [id], onDelete: Cascade)
  spell           Spell @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@unique([spellId, classId])
  @@map("spell_class_circles")
}

model SpellTargeting {
  id                 Int         @id @default(autoincrement())
  spellId            Int         @unique
  allowedTargetsMask Int
  targetScope        TargetScope @default(SINGLE)
  maxTargets         Int         @default(1)
  range              SpellRange  @default(ROOM)
  requireLos         Boolean     @default(false)
  filtersMask        Int?
  spell              Spell       @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@map("spell_targeting")
}

model SpellSavingThrow {
  id               Int        @id @default(autoincrement())
  spellId          Int
  saveType         SaveType   @default(SPELL)
  onSave           SaveResult @default(NEGATE)
  dcFormula        String
  saveModifierMask Int?
  spell            Spell      @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@map("spell_saving_throws")
}

model SpellMessage {
  id              Int     @id @default(autoincrement())
  spellId         Int     @unique
  startToCaster   String?
  startToVictim   String?
  startToRoom     String?
  successToCaster String?
  successToVictim String?
  successToRoom   String?
  failToCaster    String?
  failToVictim    String?
  failToRoom      String?
  wearoffToTarget String?
  wearoffToRoom   String?
  spell           Spell   @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@map("spell_messages")
}

model SpellComponent {
  id       Int     @id @default(autoincrement())
  spellId  Int
  objectId Int
  consumed Boolean @default(false)
  required Boolean @default(true)
  spell    Spell   @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@map("spell_components")
}

model SpellRestriction {
  id                  Int     @id @default(autoincrement())
  spellId             Int     @unique
  indoorsOnly         Boolean @default(false)
  outdoorsOnly        Boolean @default(false)
  noSafeRooms         Boolean @default(false)
  noTeleportFlagsMask Int?
  terrainMask         Int?
  disallowStatesMask  Int?
  spell               Spell   @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@map("spell_restrictions")
}

model SpellEffect {
  id              Int            @id @default(autoincrement())
  spellId         Int
  effectType      EffectType
  order           Int            @default(0)
  chancePct       Int            @default(100)
  trigger         EffectTrigger? @default(ON_CAST)
  durationFormula String?
  stackingRule    StackingRule   @default(REFRESH)
  conditionFilter Json?
  params          Json
  spell           Spell          @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@index([spellId, order])
  @@map("spell_effects")
}

model Skill {
  id              Int              @id @default(autoincrement())
  name            String           @unique
  description     String?
  type            SkillType
  category        SkillCategory    @default(SECONDARY)
  maxLevel        Int              @default(100)
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  characterSkills CharacterSkill[]
  classSkills     ClassSkill[]
  mobSkills       MobSkill[]
  raceSkills      RaceSkill[]

  @@map("skills")
}

model ClassSkill {
  id       Int           @id @default(autoincrement())
  classId  Int
  skillId  Int
  category SkillCategory @default(SECONDARY)
  minLevel Int           @default(1)
  maxLevel Int           @default(100)
  gameClass GameClass    @relation(fields: [classId], references: [id], onDelete: Cascade)
  skill    Skill         @relation(fields: [skillId], references: [id], onDelete: Cascade)

  @@unique([classId, skillId])
  @@map("class_skills")
}

model RaceSkill {
  id       Int           @id @default(autoincrement())
  race     Race
  skillId  Int
  category SkillCategory @default(SECONDARY)
  bonus    Int           @default(0)
  skill    Skill         @relation(fields: [skillId], references: [id], onDelete: Cascade)

  @@unique([race, skillId])
  @@map("race_skills")
}

model CharacterSkill {
  id          String    @id @default(cuid())
  characterId String
  skillId     Int
  level       Int       @default(0)
  experience  Int       @default(0)
  lastUsed    DateTime?
  character   Character @relation(fields: [characterId], references: [id], onDelete: Cascade)
  skill       Skill     @relation(fields: [skillId], references: [id], onDelete: Cascade)

  @@unique([characterId, skillId])
  @@map("character_skills")
}

model CharacterSpell {
  id          String    @id @default(cuid())
  characterId String
  spellId     Int
  known       Boolean   @default(false)
  proficiency Int       @default(0)
  lastCast    DateTime?
  character   Character @relation(fields: [characterId], references: [id], onDelete: Cascade)
  spell       Spell     @relation(fields: [spellId], references: [id], onDelete: Cascade)

  @@unique([characterId, spellId])
  @@map("character_spells")
}

model ChangeLog {
  id          String   @id @default(cuid())
  entityType  String
  entityId    String
  action      String
  changes     Json     @default("{}")
  userId      String
  timestamp   DateTime @default(now())
  description String?
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([entityType, entityId])
  @@index([userId, timestamp])
  @@index([timestamp])
  @@map("change_logs")
}

model BanRecord {
  id         String    @id @default(cuid())
  userId     String
  bannedBy   String
  reason     String
  bannedAt   DateTime  @default(now())
  expiresAt  DateTime?
  unbannedAt DateTime?
  unbannedBy String?
  active     Boolean   @default(true)
  admin      User      @relation("BanningAdmin", fields: [bannedBy], references: [id])
  user       User      @relation("BannedUser", fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([bannedBy])
  @@index([active])
  @@index([bannedAt])
  @@map("ban_records")
}

model CharacterItem {
  id               String          @id @default(cuid())
  characterId      String          @map("character_id")
  object_zone_id   Int
  object_id        Int
  containerId      String?         @map("container_id")
  equippedLocation String?         @map("equipped_location")
  condition        Int             @default(100)
  charges          Int             @default(-1)
  instanceFlags    String[]        @default([]) @map("instance_flags")
  customShortDesc  String?         @map("custom_short_desc")
  customLongDesc   String?         @map("custom_long_desc")
  customValues     Json            @default("{}") @map("custom_values")
  createdAt        DateTime        @default(now()) @map("created_at")
  updatedAt        DateTime        @updatedAt @map("updated_at")
  character        Character       @relation(fields: [characterId], references: [id], onDelete: Cascade)
  container        CharacterItem?  @relation("ItemContainer", fields: [containerId], references: [id])
  containedItems   CharacterItem[] @relation("ItemContainer")
  object           Object          @relation(fields: [object_zone_id, object_id], references: [zoneId, id], onDelete: Cascade)

  @@map("character_items")
}

model CharacterEffect {
  id           String    @id @default(cuid())
  characterId  String    @map("character_id")
  effectName   String    @map("effect_name")
  effectType   String?   @map("effect_type")
  duration     Int?
  strength     Int       @default(1)
  modifierData Json      @default("{}") @map("modifier_data")
  sourceType   String?   @map("source_type")
  sourceId     Int?      @map("source_id")
  appliedAt    DateTime  @default(now()) @map("applied_at")
  expiresAt    DateTime? @map("expires_at")
  character    Character @relation(fields: [characterId], references: [id], onDelete: Cascade)

  @@map("character_effects")
}

model EquipmentSetItem {
  id             String       @id
  equipmentSetId String
  objectZoneId   Int
  objectId       Int
  slot           String?
  quantity       Int          @default(1)
  probability    Float        @default(1.0)
  equipmentSet   EquipmentSet @relation(fields: [equipmentSetId], references: [id], onDelete: Cascade)
  object         Object       @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)

  @@map("equipment_set_items")
}

model EquipmentSet {
  id               String             @id
  name             String
  description      String?
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  items            EquipmentSetItem[]
  mobEquipmentSets MobEquipmentSet[]

  @@map("equipment_sets")
}

model MobEquipmentSet {
  id             String       @id
  mobResetId     String
  equipmentSetId String
  probability    Float        @default(1.0)
  equipmentSet   EquipmentSet @relation(fields: [equipmentSetId], references: [id], onDelete: Cascade)
  mobReset       MobReset     @relation(fields: [mobResetId], references: [id], onDelete: Cascade)

  @@unique([mobResetId, equipmentSetId])
  @@map("mob_equipment_sets")
}

model ObjectReset {
  id              String           @id
  max             Int              @default(1)
  name            String?
  objectZoneId    Int
  objectId        Int
  roomZoneId      Int
  roomId          Int
  zoneId          Int
  probability     Float            @default(1.0)
  object          Object           @relation(fields: [objectZoneId, objectId], references: [zoneId, id], onDelete: Cascade)
  room            Room             @relation(fields: [roomZoneId, roomId], references: [zoneId, id], onDelete: Cascade)
  zone            Zone             @relation(fields: [zoneId], references: [id], onDelete: Cascade)
  spawnConditions SpawnCondition[]

  @@map("object_resets")
}

model SpawnCondition {
  id            String       @id
  type          String
  parameters    Json         @default("{}")
  mobResetId    String?
  objectResetId String?
  mobReset      MobReset?    @relation(fields: [mobResetId], references: [id], onDelete: Cascade)
  objectReset   ObjectReset? @relation(fields: [objectResetId], references: [id], onDelete: Cascade)

  @@map("spawn_conditions")
}

enum UserRole {
  PLAYER
  IMMORTAL
  BUILDER
  CODER
  GOD
}

enum ResetMode {
  NEVER
  EMPTY
  NORMAL
}

enum Hemisphere {
  NORTHWEST
  NORTHEAST
  SOUTHWEST
  SOUTHEAST
}

enum Climate {
  NONE
  SEMIARID
  ARID
  OCEANIC
  TEMPERATE
  SUBTROPICAL
  TROPICAL
  SUBARCTIC
  ARCTIC
  ALPINE
}

enum Sector {
  STRUCTURE
  CITY
  FIELD
  FOREST
  HILLS
  MOUNTAIN
  SHALLOWS
  WATER
  UNDERWATER
  AIR
  ROAD
  GRASSLANDS
  CAVE
  RUINS
  SWAMP
  BEACH
  UNDERDARK
  ASTRALPLANE
  AIRPLANE
  FIREPLANE
  EARTHPLANE
  ETHEREALPLANE
  AVERNUS
}

enum Direction {
  NORTH
  EAST
  SOUTH
  WEST
  UP
  DOWN
}

enum ObjectType {
  NOTHING
  LIGHT
  SCROLL
  WAND
  STAFF
  WEAPON
  FIREWEAPON
  MISSILE
  TREASURE
  ARMOR
  POTION
  WORN
  OTHER
  TRASH
  TRAP
  CONTAINER
  NOTE
  DRINKCONTAINER
  KEY
  FOOD
  MONEY
  PEN
  BOAT
  FOUNTAIN
  PORTAL
  ROPE
  SPELLBOOK
  WALL
  TOUCHSTONE
  BOARD
  INSTRUMENT
}

enum ScriptType {
  MOB
  OBJECT
  WORLD
}

enum MobFlag {
  SPEC
  SENTINEL
  SCAVENGER
  IS_NPC
  AWARE
  AGGRESSIVE
  STAY_ZONE
  WIMPY
  AGGRO_EVIL
  AGGRO_GOOD
  AGGRO_NEUTRAL
  MEMORY
  HELPER
  NO_CHARM
  NO_SUMMON
  NO_SLEEP
  NO_BASH
  NO_BLIND
  MOUNT
  STAY_SECT
  HATES_SUN
  NO_KILL
  TRACK
  ILLUSION
  POISON_BITE
  THIEF
  WARRIOR
  SORCERER
  CLERIC
  PALADIN
  ANTI_PALADIN
  RANGER
  DRUID
  SHAMAN
  ASSASSIN
  MERCENARY
  NECROMANCER
  CONJURER
  MONK
  BERSERKER
  DIABOLIST
  SLOW_TRACK
  NO_SILENCE
  PEACEFUL
  PROTECTOR
  PEACEKEEPER
  HASTE
  BLUR
  TEACHER
  MOUNTABLE
  NO_VICIOUS
  NO_CLASS_AI
  FAST_TRACK
  AQUATIC
  NO_EQ_RESTRICT
  SUMMONED_MOUNT
  NO_POISON
}

enum EffectFlag {
  BLIND
  INVISIBLE
  DETECT_ALIGN
  DETECT_INVIS
  DETECT_MAGIC
  SENSE_LIFE
  WATERWALK
  SANCTUARY
  CONFUSION
  CURSE
  INFRAVISION
  POISON
  PROTECT_EVIL
  PROTECT_GOOD
  SLEEP
  NO_TRACK
  TAMED
  BERSERK
  SNEAK
  STEALTH
  FLY
  CHARM
  STONE_SKIN
  FARSEE
  HASTE
  BLUR
  VITALITY
  GLORY
  MAJOR_PARALYSIS
  FAMILIARITY
  MESMERIZED
  IMMOBILIZED
  LIGHT
  UNUSED
  MINOR_PARALYSIS
  HURT_THROAT
  FEATHER_FALL
  WATERBREATH
  SOULSHIELD
  SILENCE
  PROTECT_FIRE
  PROTECT_COLD
  PROTECT_AIR
  PROTECT_EARTH
  FIRESHIELD
  COLDSHIELD
  MINOR_GLOBE
  MAJOR_GLOBE
  HARNESS
  ON_FIRE
  FEAR
  TONGUES
  DISEASE
  INSANITY
  ULTRAVISION
  NEGATE_HEAT
  NEGATE_COLD
  NEGATE_AIR
  NEGATE_EARTH
  REMOTE_AGGRO
  AWARE
  REDUCE
  ENLARGE
  VAMPIRIC_TOUCH
  RAY_OF_ENFEEBLEMENT
  ANIMATED
  EXPOSED
  SHADOWING
  CAMOUFLAGED
  SPIRIT_WOLF
  SPIRIT_BEAR
  WRATH
  MISDIRECTION
  MISDIRECTING
  BLESS
  HEX
  DETECT_POISON
  SONG_OF_REST
  DISPLACEMENT
  GREATER_DISPLACEMENT
  FIRE_WEAPON
  ICE_WEAPON
  POISON_WEAPON
  ACID_WEAPON
  SHOCK_WEAPON
  RADIANT_WEAPON
}

enum RoomFlag {
  DARK
  DEATH
  NO_MOB
  INDOORS
  PEACEFUL
  SOUNDPROOF
  NO_TRACK
  NO_MAGIC
  TUNNEL
  PRIVATE
  GODROOM
  HOUSE
  HOUSECRASH
  ATRIUM
  OLC
  BFS_MARK
  WORLDMAP
  FERRY_DEST
  ISOLATED
  ARENA
  LARGE
  MEDIUM_LARGE
  MEDIUM
  MEDIUM_SMALL
  SMALL
  VERY_SMALL
  ONE_PERSON
  EFFECTS_NEXT
  ALWAYS_LIT
  GUILDHALL
  NO_WELL
  NO_SUMMON
  NO_SCAN
  UNDERDARK
  NO_SHIFT
  NO_RECALL
  ALT_EXIT
  OBSERVATORY
}

enum ExitFlag {
  IS_DOOR
  CLOSED
  LOCKED
  PICKPROOF
  HIDDEN
}

enum TriggerFlag {
  GLOBAL
  RANDOM
  COMMAND
  SPEECH
  ACT
  DEATH
  GREET
  GREET_ALL
  ENTRY
  RECEIVE
  FIGHT
  HIT_PERCENT
  BRIBE
  LOAD
  MEMORY
  CAST
  LEAVE
  DOOR
  TIME
  AUTO
  SPEECH_TO
  LOOK
}

enum ShopFlag {
  WILL_FIGHT
  USES_BANK
  WILL_BANK_MONEY
  WILL_START_FIGHT
}

enum ShopTradesWith {
  ALIGNMENT
  RACE
  CLASS
  TRADE_NOGOOD
  TRADE_NOEVIL
  TRADE_NONEUTRAL
  TRADE_NOCLERIC
  TRADE_NOTHIEF
  TRADE_NOWARRIOR
}

enum Gender {
  NEUTRAL
  MALE
  FEMALE
  NON_BINARY
}

enum Race {
  HUMAN
  ELF
  GNOME
  DWARF
  TROLL
  DROW
  DUERGAR
  OGRE
  ORC
  HALF_ELF
  BARBARIAN
  HALFLING
  PLANT
  HUMANOID
  ANIMAL
  DRAGON_GENERAL
  GIANT
  OTHER
  GOBLIN
  DEMON
  BROWNIE
  DRAGON_FIRE
  DRAGON_FROST
  DRAGON_ACID
  DRAGON_LIGHTNING
  DRAGON_GAS
  DRAGONBORN_FIRE
  DRAGONBORN_FROST
  DRAGONBORN_ACID
  DRAGONBORN_LIGHTNING
  DRAGONBORN_GAS
  SVERFNEBLIN
  FAERIE_SEELIE
  FAERIE_UNSEELIE
  NYMPH
  ARBOREAN
}

enum Position {
  PRONE
  SITTING
  KNEELING
  STANDING
  FLYING
}

enum LifeForce {
  LIFE
  UNDEAD
  MAGIC
  CELESTIAL
  DEMONIC
  ELEMENTAL
}

enum Composition {
  FLESH
  EARTH
  AIR
  FIRE
  WATER
  ICE
  MIST
  ETHER
  METAL
  STONE
  BONE
  LAVA
  PLANT
}

enum Stance {
  DEAD
  MORT
  INCAPACITATED
  STUNNED
  SLEEPING
  RESTING
  ALERT
  FIGHTING
}

enum DamageType {
  HIT
  STING
  WHIP
  SLASH
  BITE
  BLUDGEON
  CRUSH
  POUND
  CLAW
  MAUL
  THRASH
  PIERCE
  BLAST
  PUNCH
  STAB
  FIRE
  COLD
  ACID
  SHOCK
  POISON
  ALIGN
}

enum Size {
  TINY
  SMALL
  MEDIUM
  LARGE
  HUGE
  GIANT
  GARGANTUAN
  COLOSSAL
  TITANIC
  MOUNTAINOUS
}

enum ObjectFlag {
  GLOW
  HUM
  NO_RENT
  ANTI_BERSERKER
  NO_INVISIBLE
  INVISIBLE
  MAGIC
  NO_DROP
  PERMANENT
  ANTI_GOOD
  ANTI_EVIL
  ANTI_NEUTRAL
  ANTI_SORCERER
  ANTI_CLERIC
  ANTI_ROGUE
  ANTI_WARRIOR
  NO_SELL
  ANTI_PALADIN
  ANTI_ANTI_PALADIN
  ANTI_RANGER
  ANTI_DRUID
  ANTI_SHAMAN
  ANTI_ASSASSIN
  ANTI_MERCENARY
  ANTI_NECROMANCER
  ANTI_CONJURER
  NO_BURN
  NO_LOCATE
  DECOMPOSING
  FLOAT
  NO_FALL
  WAS_DISARMED
  ANTI_MONK
  ANTI_BARD
  ELVEN
  DWARVEN
  ANTI_THIEF
  ANTI_PYROMANCER
  ANTI_CRYOMANCER
  ANTI_ILLUSIONIST
  ANTI_PRIEST
  ANTI_DIABOLIST
  ANTI_TINY
  ANTI_SMALL
  ANTI_MEDIUM
  ANTI_LARGE
  ANTI_HUGE
  ANTI_GIANT
  ANTI_GARGANTUAN
  ANTI_COLOSSAL
  ANTI_TITANIC
  ANTI_MOUNTAINOUS
  ANTI_ARBOREAN
}

enum WearFlag {
  TAKE
  FINGER
  NECK
  BODY
  HEAD
  LEGS
  FEET
  HANDS
  ARMS
  SHIELD
  ABOUT
  WAIST
  WRIST
  WIELD
  HOLD
  TWO_HAND_WIELD
  EYES
  FACE
  EAR
  BADGE
  BELT
  HOVER
}

enum TargetScope {
  SINGLE
  ROOM
  GROUP
  AREA
  CHAIN
  CONE
  LINE
}

enum SpellRange {
  SELF
  TOUCH
  ROOM
  ADJACENT_ROOM
  WORLD
}

enum SaveType {
  SPELL
  POISON
  BREATH
  PARALYSIS
  WAND
}

enum SaveResult {
  NONE
  HALF
  NEGATE
  REDUCE25
  CUSTOM
}

enum EffectType {
  DAMAGE
  HEAL
  STAT_MOD
  AFFECT_FLAG
  DISPEL
  TELEPORT
  SUMMON
  CREATE_OBJECT
  RESOURCE
  OBJ_AFFECT
  ROOM_AFFECT
  CLEANSE
  REMOVE_CURSE
  SCRIPT
}

enum EffectTrigger {
  ON_CAST
  ON_HIT
  ON_KILL
  ON_SAVE
  ON_FAIL
}

enum StackingRule {
  REFRESH
  STACK
  IGNORE
  MAX_ONLY
}

enum SkillType {
  WEAPON
  COMBAT
  MAGIC
  STEALTH
  SOCIAL
  CRAFTING
  SURVIVAL
  KNOWLEDGE
  UTILITY
}

enum SkillCategory {
  PRIMARY
  SECONDARY
  RESTRICTED
  FORBIDDEN
}
