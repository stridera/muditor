# Abilities-related operations for codegen

query GetAbilities($skip: Int, $take: Int, $abilityType: String, $search: String) {
  abilities(abilityType: $abilityType, skip: $skip, take: $take, search: $search) {
    id
    name
    abilityType
    description
    minPosition
    violent
    castTimeRounds
    cooldownMs
    inCombatOnly
    isArea
    notes
    tags
    school {
      id
      name
    }
    effects {
      effectId
      effect {
        id
        name
      }
    }
  }
  abilitiesCount(abilityType: $abilityType, search: $search)
}

query GetAbilityDetails($id: ID!) {
  ability(id: $id) {
    id
    name
    abilityType
    description
    minPosition
    violent
    combatOk
    castTimeRounds
    cooldownMs
    inCombatOnly
    isArea
    notes
    tags
    luaScript
    # Spell metadata
    sphere
    damageType
    pages
    memorizationTime
    questOnly
    humanoidOnly
    school {
      id
      name
      description
    }
    effects {
      effectId
      order
      chancePct
      trigger
      condition
      overrideParams
      effect {
        id
        name
        effectType
        description
      }
    }
    savingThrows {
      id
      dcFormula
      saveType
      onSaveAction
    }
    targeting {
      range
      maxTargets
      requireLos
      scope
      scopePattern
      validTargets
    }
    restrictions {
      customRequirementLua
      requirements
    }
    messages {
      startToCaster
      startToRoom
      startToVictim
      successToCaster
      successToRoom
      successToVictim
      successToSelf
      successSelfRoom
      failToCaster
      failToRoom
      failToVictim
      wearoffToRoom
      wearoffToTarget
      lookMessage
    }
  }
}

query GetAbilitySchools {
  abilitySchools {
    id
    name
    description
  }
}

mutation CreateAbility($data: CreateAbilityInput!) {
  createAbility(data: $data) {
    id
    name
    abilityType
  }
}

mutation UpdateAbility($id: ID!, $data: UpdateAbilityInput!) {
  updateAbility(id: $id, data: $data) {
    id
    name
    abilityType
  }
}

mutation DeleteAbility($id: ID!) {
  deleteAbility(id: $id)
}

mutation UpdateAbilityEffects($abilityId: Int!, $data: UpdateAbilityEffectsInput!) {
  updateAbilityEffects(abilityId: $abilityId, data: $data) {
    id
    name
    effects {
      effectId
      order
      chancePct
      trigger
      condition
      overrideParams
      effect {
        id
        name
        effectType
        description
      }
    }
  }
}

mutation UpdateAbilityMessages($abilityId: Int!, $data: UpdateAbilityMessagesInput!) {
  updateAbilityMessages(abilityId: $abilityId, data: $data) {
    startToCaster
    startToRoom
    startToVictim
    successToCaster
    successToRoom
    successToVictim
    successToSelf
    successSelfRoom
    failToCaster
    failToRoom
    failToVictim
    wearoffToRoom
    wearoffToTarget
    lookMessage
  }
}
